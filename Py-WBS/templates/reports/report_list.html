{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/report_list.css' %}">

<h2>ì—…ë¬´ í˜„í™©</h2>

<div class="top-bar">
  <form method="get" class="filter-form">
    <label>í”„ë¡œì íŠ¸</label>
    <select name="project">
    <option value="">ì „ì²´</option>
    {% for project in projects %}
    <option value="{{ project.id }}" {% if project.id|stringformat:"s" == selected_project_id %}selected{% endif %}>{{ project.name }}</option>
  {% endfor %}
</select>

    <label>ë‚ ì§œ</label>
  <input type="date" name="date" id="dateInput" value="{{ selected_date|default:today }}">
  <button type="button" class="btn btn-secondary" onclick="document.getElementById('dateInput').value='';">ì „ì²´</button>

    <button type="submit" class="btn">ì¡°íšŒ</button>
  </form>

  <a href="{% url 'report_create' %}" class="btn btn-primary add-btn">+ ì—…ë¬´ ì¶”ê°€</a>
</div>

<hr>

{% if reports %}
  <h3>ê¸ˆì¼ ì—…ë¬´ ê²°ê³¼</h3>
  <div class="report-header">
    <div>í”„ë¡œì íŠ¸</div>
    <div>ì—…ë¬´ ë‚´ìš©</div>
    <div>ì™„ë£Œê¸°í•œ / ì§„í–‰ë¥ </div>
    <div>êµ¬ë¶„</div>
    <div>ì‘ì—…</div>
  </div>

  {% for report in reports %}
    {% if report.today_result %}
      <div class="report-row">
        <div>{{ report.project.name }}</div>
        <div>{{ report.today_result }}</div>
        <div>{{ report.project.end_date }} / {{ report.project.progress_rate }}%</div>
        <div>ê¸ˆì¼ ì—…ë¬´ ê²°ê³¼</div>
        <div class="button-group">
          <a href="{% url 'report_edit' report.id %}" class="btn btn-primary">âœï¸</a>
          <a href="{% url 'report_delete' report.id %}" class="btn btn-danger" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘</a>
        </div>
      </div>
    {% endif %}
  {% endfor %}

  <hr>

  <h3>ìµì¼ ì—…ë¬´ ì˜ˆì •</h3>
  <div class="report-header">
    <div>í”„ë¡œì íŠ¸</div>
    <div>ì—…ë¬´ ë‚´ìš©</div>
    <div>ì™„ë£Œê¸°í•œ / ì§„í–‰ë¥ </div>
    <div>êµ¬ë¶„</div>
    <div>ì‘ì—…</div>
  </div>

  {% for report in reports %}
    {% if report.tomorrow_plan %}
      <div class="report-row">
        <div>{{ report.project.name }}</div>
        <div>{{ report.tomorrow_plan }}</div>
        <div>{{ report.project.end_date }} / {{ report.project.progress_rate }}%</div>
        <div>ìµì¼ ì—…ë¬´ ì˜ˆì •</div>
        <div class="button-group">
          <a href="{% url 'report_edit' report.id %}" class="btn btn-primary">âœï¸</a>
          <a href="{% url 'report_delete' report.id %}" class="btn btn-danger" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘</a>
        </div>
      </div>
    {% endif %}
  {% endfor %}
{% else %}
  <p>í•´ë‹¹ ì¡°ê±´ì˜ ë³´ê³ ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}
